1. Clean up the code and reduce repeated parts